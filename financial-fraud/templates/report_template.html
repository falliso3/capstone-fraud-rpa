<html>
<head>
  <title>Fraud Detection Metrics Report</title>
  <style>
    body { font-family: Arial; margin: 2em; background: #f8f9fa; }
    table { border-collapse: collapse; width: 50%; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    .placeholder {
      width: 400px; height: 300px; background: #eee;
      display: flex; align-items: center; justify-content: center;
      border: 2px dashed #aaa;
    }
    .timestamp { color: #555; margin-bottom: 1em; }
    .cm-table {
      border-collapse: collapse;
      text-align: center;
      margin: 1em auto;
    }
    .cm-table th, .cm-table td {
      border: 1px solid #999;
      width: 90px;
      height: 90px;
      font-family: sans-serif;
      font-size: 14px;
    }
    .cm-corner {
      position: relative;
      background: linear-gradient(to bottom left, #cfcfcf 49%, #000 50%, #cfcfcf 51%);
    }
    .cm-corner span {
      position: absolute;
      font-weight: bold;
      color: #333;
      width: 55%;
      height: 78%;
      line-height: 70px;
      font-size: clamp(9px, 1.2vw, 14px);
    }
    .cm-actual {
      bottom: 0;
      left: 0;
    }
    .cm-pred {
      top: 0;
      right: 0;
    }
    .cm-explanation {
      text-align: center;
      font-size: 0.9em;
      margin-bottom: 0.5em;
      font-family: sans-serif;
  }
  </style>
</head>
<body>
  <h1>Fraud Detection Metrics Report</h1>
  <div class="timestamp">Generated {{ timestamp }}</div>
  <table>
    <tr><th>Metric</th><th>Value</th></tr>
    {% for name, value in metrics.items() %}
      <tr><td>{{ name.capitalize() }}</td><td>{{ value }}%</td></tr>
    {% endfor %}
  </table>
  <h2>Confusion Matrix</h2>
  {{ cm_html | safe }}
  <p class="cm-explanation">
    The confusion matrix shows how well the fraud detection algorithm classified transactions. 
    Each row is the <strong>actual</strong> value (0 = No Fraud, 1 = Suspicious, 2 = Fraud), 
    and each column is the <strong>predicted</strong> value. 
    Numbers indicate how many transactions fell into each actual/predicted combination. 
    Higher counts along the diagonal indicate correct predictions, 
    and the highest count in any cell is <strong>{{ cm_max }}</strong>.
  </p>
</body>
</html>